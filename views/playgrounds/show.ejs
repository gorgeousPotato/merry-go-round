<%- include("../partials/header") %>
<h2 class="title"><%= playground.title %></h2>
<div class="first-page">
  <div class="all-pg-page">
    <p>Minimum age: <%= playground.minAge %></p>
    <h3>Equipment:</h3>
    <div class="equip-table">
      <p>Slides</p>
      <p><%= playground.slides ? 'Yes' : 'No' %></p>
      <p>Swings</p>
      <p><%= playground.swings ? 'Yes' : 'No' %></p>
      <p>Sandxbox</p>
      <p><%= playground.sandbox ? 'Yes' : 'No' %></p>
      <p>Spraypark</p>
      <p><%= playground.spraypark ? 'Yes' : 'No' %></p>
    </div>
    <h3><a href="/playgrounds/<%= playground._id %>/photos">Photos</a></h3>
    <h3><a href="/playgrounds/<%= playground._id %>/reviews">Reviews</a></h3>
  </div>
  <div class="all-pg-map">
    <div id="map" style="width: 30rem; height: 40rem"></div>
    <script>
      mapboxgl.accessToken =
        "pk.eyJ1IjoiYmVhdXRpZnVscG90YXRvIiwiYSI6ImNsbHF0cXVwbzA0bWczc3N5YWM3OG4zMDMifQ.Tw_QZOJgFO36cVeypud_QQ";
        const map = new mapboxgl.Map({
        container: "map", // container ID
        // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
        style: "mapbox://styles/mapbox/streets-v12", // style URL
        center: [Number("<%-playground.lon%>"), Number("<%-playground.lat%>")], // starting center in [lng, lat]
        zoom: 8, // starting zoom
      });

      // Add geolocate control to the map.
      map.addControl(
        new mapboxgl.GeolocateControl({
          positionOptions: {
            enableHighAccuracy: true,
          },
          // When active the map will receive updates to the device's location as it changes.
          trackUserLocation: true,
          // Draw an arrow next to the location dot to indicate which direction the device is heading.
          showUserHeading: true,
        })
      );
      const geojson = {
        type: "FeatureCollection",
        features: [
          {
            type: "Feature",
            geometry: {
              type: "Point",
              coordinates: [
                Number("<%-playground.lon%>"),
                Number("<%-playground.lat%>"),
              ],
            },
            properties: {
              title: "Playground",
              description: "<%-playground.title%>",
            },
          },
        ],
      };
      // add markers to map
      for (const feature of geojson.features) {
        // create a HTML element for each feature
        const el = document.createElement("div");
        el.className = "marker";

        // make a marker for each feature and add to the map
        new mapboxgl.Marker(el)
          .setLngLat(feature.geometry.coordinates)
          .setPopup(
            new mapboxgl.Popup({ offset: 25 }) // add popups
              .setHTML(
                `<h3>${feature.properties.title}</h3><p>${feature.properties.description}</p>`
              )
          )
          .addTo(map);
      }
    </script>
  </div>
  </div>

  <%- include("../partials/footer") %>
</div>
